(()=>{function e(e){return document.querySelector(e)}const t=e("#chat-input")||document.querySelector('#sandra input[type="text"], #sandra input[type="search"], #panel-text input[type="text"], #panel-text input[type="search"]'),n=e("#chat-log")||document.getElementById("chat-log");function o(e,t="bot"){if(!n)return;const o=document.createElement("div");o.style.margin="6px 0",o.textContent=("yo"===t?"ðŸ§‘ ":"ðŸ¤– ")+e,n.appendChild(o),n.scrollTop=n.scrollHeight}function r(){console.info("wire-up.js listo | API:",{SandraAPI:typeof window.SandraAPI,UI:typeof window.SandraUI,sandraIA:typeof window.sandraIA,input:!!t,log:!!n})}async function a(){const e=(t?.value||"").trim();if(!e)return;o(e,"yo"),t&&(t.value="");try{if(window.SandraAPI&&"function"==typeof window.SandraAPI.sendText){const t=await window.SandraAPI.sendText(e);return void o(t?.reply||JSON.stringify(t)||"âœ“ Enviado")}if(window.sandraIA&&"function"==typeof window.sandraIA.chat){const t=await window.sandraIA.chat(e);return void o(t?.reply||JSON.stringify(t)||"âœ“ Enviado")}let n=await fetch("/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});if(404===n.status||405===n.status){n=await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})})}const r=await n.json();o(r?.reply||JSON.stringify(r)||"âœ“ Enviado")}catch(e){o("Error envÃ­o: "+(e?.message||e))}}function s(){let n=e("#send-btn")||e("[data-send]");if(!n){const t=Array.from(document.querySelectorAll("#panel-text button, #sandra button, button"));n=t.find((e=>/enviar/i.test(e.textContent||"")))||t.find((e=>e.dataset?.send))||t[0]}n&&n.addEventListener("click",a),t&&t.addEventListener("keydown",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),a())}));const o=t?.closest("form");o&&o.addEventListener("submit",(e=>{e.preventDefault()}))}document.addEventListener("DOMContentLoaded",(()=>{s(),r()}));"complete"===document.readyState&&(s(),r())})();